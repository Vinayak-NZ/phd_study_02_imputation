se_mice_mcar_20 <-
derive_treatment_se_mean(sc_mice_model_mcar_20)
derive_treatment_se_mean <- function(input){
effect_low <- c()
effect_hi <- c()
for(i in 1:100){
effect_low[i] <- input[[i]][[2]]$`lo 95`[[2]]
effect_hi[i] <- input[[i]][[2]]$`hi 95`[[2]]
}
mean_low <- mean(effect_low)
mean_high <- mean(effect_hi)
return(list(mean_low, mean_high))
}
se_mice_mcar_20 <-
derive_treatment_se_mean(sc_mice_model_mcar_20)
se_mice_mcar_20
se_mice_mcar_20[[1]]
source("R/00_load_functions.R")
source("R/00_load_package.R")
source("R/01_load_data.R")
source("R/02_data_edit.R")
source("R/03_create_synthetic_data.R")
source("R/04_simulate_missingness.R")
source("R/06_modelling_observed.R")
observed_model_summary_sc
effect_mice_mcar_20
sc_mice_model_mcar_20[[1]]
sc_effect_mice_mcar_20 <-
derive_treatment_effect_mean(sc_mice_model_mcar_20)
sc_se_mice_mcar_20 <-
derive_treatment_se_mean(sc_mice_model_mcar_20)
sc_effect_j2r_mcar_20 <-
derive_treatment_effect_mean(sc_j2r_model_mcar_20)
sc_se_j2r_mcar_20 <-
derive_treatment_se_mean(sc_j2r_model_mcar_20)
sc_effect_locf_mcar_20 <-
derive_treatment_effect_mean_ns(sc_locf_model_mcar_20)
sc_se_locf_mcar_20 <-
derive_treatment_se_mean_ns(sc_locf_model_mcar_20)
sc_effect_lwd_mcar_20 <-
derive_treatment_effect_mean_ns(sc_lwd_model_mcar_20)
sc_se_lwd_mcar_20 <-
derive_treatment_se_mean_ns(sc_lwd_model_mcar_20)
data_estimates_sc_mcar_20 <-
data.frame(source = c("MICE", "J2R", "LOCF", "LWD"),
point_estimate = c(sc_effect_mice_mcar_20,
sc_effect_j2r_mcar_20,
sc_effect_locf_mcar_20,
sc_effect_lwd_mcar_20),
lower = c(sc_se_mice_mcar_20[[1]],
sc_se_j2r_mcar_20[[1]],
sc_se_locf_mcar_20[[1]],
sc_se_lwd_mcar_20[[1]]),
upper = c(sc_se_mice_mcar_20[[2]],
sc_se_j2r_mcar_20[[2]],
sc_se_locf_mcar_20[[2]],
sc_se_lwd_mcar_20[[2]]))
View(data_estimates_sc_mcar_20)
data_estimates_sc_mcar_20$source <-
factor(data_estimates_sc_mcar_20$source,
levels = c("Observed", "MICE", "J2R", "LOCF", "LWD"))
plot_estimates_sc <-
ggplot(data_estimates_sc_mcar_20, aes(source, point_estimate)) +
geom_point() +
geom_errorbar(aes(ymin = lower, ymax = upper)) +
geom_hline(yintercept = observed_model_summary_sc$coefficients[2] - observed_model_summary_sc$coefficients[2, 2],
linetype = "dashed",
size = 1,
color = "#46e7fd") +
geom_hline(yintercept = observed_model_summary_sc$coefficients[2],
size = 2,
color = "#e18b22") +
geom_hline(yintercept = observed_model_summary_sc$coefficients[2] + observed_model_summary_sc$coefficients[2, 2],
linetype = "dashed",
size = 1,
color = "#4739a2") +
labs(title = "Estimating treatment effect on self-care",
subtitle = "Estimates and Confidence Intervals",
caption = "Data source: Cardiovascular Rehabilitation Tool") +
xlab("Method for managing dropout") +
ylab("Parameter estimate") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
plot.title = element_text(color = "#2F2E41", size = 12, face = "bold"),
plot.subtitle = element_text(color = "#454543", face = "bold"),
plot.caption = element_text(color = "#454543", face = "italic"))
plot_estimates_sc <-
ggplot(data_estimates_sc_mcar_20, aes(source, point_estimate)) +
geom_point() +
geom_errorbar(aes(ymin = lower, ymax = upper)) +
geom_hline(yintercept = observed_model_summary_sc$coefficients[2] - observed_model_summary_sc$coefficients[2, 2],
linetype = "dashed",
size = 1,
color = "#46e7fd") +
geom_hline(yintercept = observed_model_summary_sc$coefficients[2],
size = 2,
color = "#e18b22") +
geom_hline(yintercept = observed_model_summary_sc$coefficients[2] + observed_model_summary_sc$coefficients[2, 2],
linetype = "dashed",
size = 1,
color = "#4739a2") +
labs(title = "Estimating treatment effect on self-care",
subtitle = "Estimates and Confidence Intervals",
caption = "Data source: Cardiovascular Rehabilitation Tool") +
xlab("Method for managing dropout") +
ylab("Parameter estimate") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
plot.title = element_text(color = "#2F2E41", linewidth = 12, face = "bold"),
plot.subtitle = element_text(color = "#454543", face = "bold"),
plot.caption = element_text(color = "#454543", face = "italic"))
plot_estimates_sc <-
ggplot(data_estimates_sc_mcar_20, aes(source, point_estimate)) +
geom_point() +
geom_errorbar(aes(ymin = lower, ymax = upper)) +
geom_hline(yintercept = observed_model_summary_sc$coefficients[2] - observed_model_summary_sc$coefficients[2, 2],
linetype = "dashed",
linewidth = 1,
color = "#46e7fd") +
geom_hline(yintercept = observed_model_summary_sc$coefficients[2],
linewidth = 2,
color = "#e18b22") +
geom_hline(yintercept = observed_model_summary_sc$coefficients[2] + observed_model_summary_sc$coefficients[2, 2],
linetype = "dashed",
linewidth = 1,
color = "#4739a2") +
labs(title = "Estimating treatment effect on self-care",
subtitle = "Estimates and Confidence Intervals",
caption = "Data source: Cardiovascular Rehabilitation Tool") +
xlab("Method for managing dropout") +
ylab("Parameter estimate") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
plot.title = element_text(color = "#2F2E41", size = 12, face = "bold"),
plot.subtitle = element_text(color = "#454543", face = "bold"),
plot.caption = element_text(color = "#454543", face = "italic"))
plot_estimates_sc
observed_model_summary_sc
install.packages("cowplot")
library(cowplot)
sc_mice_model_mar_30[[1]]
sc_mice_model_mnar_30[[1]]
sc_mice_model_mnar_30[[1]][[2]][[12]]
sc_mice_model_mnar_30[[1]][[2]]$est[[12]]
sc_j2r_model_mnar_30[[1]][[2]]$est[[12]]
sc_locf_model_mnar_30[[1]]
sc_locf_model_mnar_30[[1]][[1]]$coefficients
observed_model_summary_sc$coefficients
observed_sc_low <- observed_model_summary_sc$coefficients[12] -  1.96*(observed_model_summary_sc$coefficients[12, 2])
observed_sc_low
source("R/00_load_functions.R")
## ---- visualise-estimates
source("R/08_pool_effects_J2R.R")
source("R/08_pool_effects_LOCF.R")
source("R/08_pool_effects_LWD.R")
source("R/08_pool_effects_MICE.R")
source("R/08_treatment_effect_data.R")
source("R/08_create_treatment_effect_data.R")
source("R/08_create_treatment_effect_data.R")
source("R/09_visualise_estimates.R")
observed_sc_low <-
observed_model_summary_sc$coefficients[12] -
1.96*(observed_model_summary_sc$coefficients[12, 2])
observed_sc_est <-
observed_model_summary_sc$coefficients[12]
Observed_sc_high <-
observed_model_summary_sc$coefficients[12] +
1.96*(observed_model_summary_sc$coefficients[12, 2])
observed_pa_low <-
observed_model_summary_pa$coefficients[12] -
1.96*(observed_model_summary_pa$coefficients[12, 2])
observed_pa_est <-
observed_model_summary_pa$coefficients[12]
Observed_pa_high <-
observed_model_summary_pa$coefficients[12] +
1.96*(observed_model_summary_pa$coefficients[12, 2])
data_estimates_sc_mcar_20$source <-
factor(data_estimates_sc_mcar_20$source,
levels = c("Observed", "MICE", "J2R", "LOCF", "LWD"))
plot_estimates_sc_mcar_20 <-
ggplot(data_estimates_sc_mcar_20, aes(source, point_estimate)) +
geom_point() +
geom_errorbar(aes(ymin = lower, ymax = upper)) +
geom_hline(yintercept = observed_sc_low,
linetype = "dashed",
linewidth = 1,
color = "#46e7fd") +
geom_hline(yintercept = observed_sc_est,
linewidth = 2,
color = "#e18b22") +
geom_hline(yintercept = observed_sc_low,
linetype = "dashed",
linewidth = 1,
color = "#4739a2") +
labs(title = "Estimating treatment effect on self-care",
subtitle = "Estimates and Confidence Intervals",
caption = "Data source: Cardiovascular Rehabilitation Tool") +
xlab("Method for managing dropout") +
ylab("Parameter estimate") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
plot.title = element_text(color = "#2F2E41", size = 12, face = "bold"),
plot.subtitle = element_text(color = "#454543", face = "bold"),
plot.caption = element_text(color = "#454543", face = "italic"))
data_estimates_sc_mcar_30$source <-
factor(data_estimates_sc_mcar_30$source,
levels = c("Observed", "MICE", "J2R", "LOCF", "LWD"))
plot_estimates_sc_mcar_30 <-
ggplot(data_estimates_sc_mcar_30, aes(source, point_estimate)) +
geom_point() +
geom_errorbar(aes(ymin = lower, ymax = upper)) +
geom_hline(yintercept = observed_sc_low,
linetype = "dashed",
linewidth = 1,
color = "#46e7fd") +
geom_hline(yintercept = observed_sc_est,
linewidth = 2,
color = "#e18b22") +
geom_hline(yintercept = observed_sc_low,
linetype = "dashed",
linewidth = 1,
color = "#4739a2") +
labs(title = "Estimating treatment effect on self-care",
subtitle = "Estimates and Confidence Intervals",
caption = "Data source: Cardiovascular Rehabilitation Tool") +
xlab("Method for managing dropout") +
ylab("Parameter estimate") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
plot.title = element_text(color = "#2F2E41", size = 12, face = "bold"),
plot.subtitle = element_text(color = "#454543", face = "bold"),
plot.caption = element_text(color = "#454543", face = "italic"))
data_estimates_sc_mcar_40$source <-
factor(data_estimates_sc_mcar_40$source,
levels = c("Observed", "MICE", "J2R", "LOCF", "LWD"))
plot_estimates_sc_mcar_40 <-
ggplot(data_estimates_sc_mcar_40, aes(source, point_estimate)) +
geom_point() +
geom_errorbar(aes(ymin = lower, ymax = upper)) +
geom_hline(yintercept = observed_sc_low,
linetype = "dashed",
linewidth = 1,
color = "#46e7fd") +
geom_hline(yintercept = observed_sc_est,
linewidth = 2,
color = "#e18b22") +
geom_hline(yintercept = observed_sc_low,
linetype = "dashed",
linewidth = 1,
color = "#4739a2") +
labs(title = "Estimating treatment effect on self-care",
subtitle = "Estimates and Confidence Intervals",
caption = "Data source: Cardiovascular Rehabilitation Tool") +
xlab("Method for managing dropout") +
ylab("Parameter estimate") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
plot.title = element_text(color = "#2F2E41", size = 12, face = "bold"),
plot.subtitle = element_text(color = "#454543", face = "bold"),
plot.caption = element_text(color = "#454543", face = "italic"))
data_estimates_sc_mar_20$source <-
factor(data_estimates_sc_mar_20$source,
levels = c("Observed", "MICE", "J2R", "LOCF", "LWD"))
plot_estimates_sc_mar_20 <-
ggplot(data_estimates_sc_mar_20, aes(source, point_estimate)) +
geom_point() +
geom_errorbar(aes(ymin = lower, ymax = upper)) +
geom_hline(yintercept = observed_sc_low,
linetype = "dashed",
linewidth = 1,
color = "#46e7fd") +
geom_hline(yintercept = observed_sc_est,
linewidth = 2,
color = "#e18b22") +
geom_hline(yintercept = observed_sc_low,
linetype = "dashed",
linewidth = 1,
color = "#4739a2") +
labs(title = "Estimating treatment effect on self-care",
subtitle = "Estimates and Confidence Intervals",
caption = "Data source: Cardiovascular Rehabilitation Tool") +
xlab("Method for managing dropout") +
ylab("Parameter estimate") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
plot.title = element_text(color = "#2F2E41", size = 12, face = "bold"),
plot.subtitle = element_text(color = "#454543", face = "bold"),
plot.caption = element_text(color = "#454543", face = "italic"))
data_estimates_sc_mar_30$source <-
factor(data_estimates_sc_mar_30$source,
levels = c("Observed", "MICE", "J2R", "LOCF", "LWD"))
plot_estimates_sc_mar_30 <-
ggplot(data_estimates_sc_mar_30, aes(source, point_estimate)) +
geom_point() +
geom_errorbar(aes(ymin = lower, ymax = upper)) +
geom_hline(yintercept = observed_sc_low,
linetype = "dashed",
linewidth = 1,
color = "#46e7fd") +
geom_hline(yintercept = observed_sc_est,
linewidth = 2,
color = "#e18b22") +
geom_hline(yintercept = observed_sc_low,
linetype = "dashed",
linewidth = 1,
color = "#4739a2") +
labs(title = "Estimating treatment effect on self-care",
subtitle = "Estimates and Confidence Intervals",
caption = "Data source: Cardiovascular Rehabilitation Tool") +
xlab("Method for managing dropout") +
ylab("Parameter estimate") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
plot.title = element_text(color = "#2F2E41", size = 12, face = "bold"),
plot.subtitle = element_text(color = "#454543", face = "bold"),
plot.caption = element_text(color = "#454543", face = "italic"))
data_estimates_sc_mar_40$source <-
factor(data_estimates_sc_mar_40$source,
levels = c("Observed", "MICE", "J2R", "LOCF", "LWD"))
plot_estimates_sc_mar_40 <-
ggplot(data_estimates_sc_mar_40, aes(source, point_estimate)) +
geom_point() +
geom_errorbar(aes(ymin = lower, ymax = upper)) +
geom_hline(yintercept = observed_sc_low,
linetype = "dashed",
linewidth = 1,
color = "#46e7fd") +
geom_hline(yintercept = observed_sc_est,
linewidth = 2,
color = "#e18b22") +
geom_hline(yintercept = observed_sc_low,
linetype = "dashed",
linewidth = 1,
color = "#4739a2") +
labs(title = "Estimating treatment effect on self-care",
subtitle = "Estimates and Confidence Intervals",
caption = "Data source: Cardiovascular Rehabilitation Tool") +
xlab("Method for managing dropout") +
ylab("Parameter estimate") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
plot.title = element_text(color = "#2F2E41", size = 12, face = "bold"),
plot.subtitle = element_text(color = "#454543", face = "bold"),
plot.caption = element_text(color = "#454543", face = "italic"))
data_estimates_sc_mnar_20$source <-
factor(data_estimates_sc_mnar_20$source,
levels = c("Observed", "MICE", "J2R", "LOCF", "LWD"))
plot_estimates_sc_mnar_20 <-
ggplot(data_estimates_sc_mnar_20, aes(source, point_estimate)) +
geom_point() +
geom_errorbar(aes(ymin = lower, ymax = upper)) +
geom_hline(yintercept = observed_sc_low,
linetype = "dashed",
linewidth = 1,
color = "#46e7fd") +
geom_hline(yintercept = observed_sc_est,
linewidth = 2,
color = "#e18b22") +
geom_hline(yintercept = observed_sc_low,
linetype = "dashed",
linewidth = 1,
color = "#4739a2") +
labs(title = "Estimating treatment effect on self-care",
subtitle = "Estimates and Confidence Intervals",
caption = "Data source: Cardiovascular Rehabilitation Tool") +
xlab("Method for managing dropout") +
ylab("Parameter estimate") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
plot.title = element_text(color = "#2F2E41", size = 12, face = "bold"),
plot.subtitle = element_text(color = "#454543", face = "bold"),
plot.caption = element_text(color = "#454543", face = "italic"))
data_estimates_sc_mnar_30$source <-
factor(data_estimates_sc_mnar_30$source,
levels = c("Observed", "MICE", "J2R", "LOCF", "LWD"))
plot_estimates_sc_mnar_30 <-
ggplot(data_estimates_sc_mnar_30, aes(source, point_estimate)) +
geom_point() +
geom_errorbar(aes(ymin = lower, ymax = upper)) +
geom_hline(yintercept = observed_sc_low,
linetype = "dashed",
linewidth = 1,
color = "#46e7fd") +
geom_hline(yintercept = observed_sc_est,
linewidth = 2,
color = "#e18b22") +
geom_hline(yintercept = observed_sc_low,
linetype = "dashed",
linewidth = 1,
color = "#4739a2") +
labs(title = "Estimating treatment effect on self-care",
subtitle = "Estimates and Confidence Intervals",
caption = "Data source: Cardiovascular Rehabilitation Tool") +
xlab("Method for managing dropout") +
ylab("Parameter estimate") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
plot.title = element_text(color = "#2F2E41", size = 12, face = "bold"),
plot.subtitle = element_text(color = "#454543", face = "bold"),
plot.caption = element_text(color = "#454543", face = "italic"))
data_estimates_sc_mnar_40$source <-
factor(data_estimates_sc_mnar_40$source,
levels = c("Observed", "MICE", "J2R", "LOCF", "LWD"))
plot_estimates_sc_mnar_40 <-
ggplot(data_estimates_sc_mnar_40, aes(source, point_estimate)) +
geom_point() +
geom_errorbar(aes(ymin = lower, ymax = upper)) +
geom_hline(yintercept = observed_sc_low,
linetype = "dashed",
linewidth = 1,
color = "#46e7fd") +
geom_hline(yintercept = observed_sc_est,
linewidth = 2,
color = "#e18b22") +
geom_hline(yintercept = observed_sc_low,
linetype = "dashed",
linewidth = 1,
color = "#4739a2") +
labs(title = "Estimating treatment effect on self-care",
subtitle = "Estimates and Confidence Intervals",
caption = "Data source: Cardiovascular Rehabilitation Tool") +
xlab("Method for managing dropout") +
ylab("Parameter estimate") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
plot.title = element_text(color = "#2F2E41", size = 12, face = "bold"),
plot.subtitle = element_text(color = "#454543", face = "bold"),
plot.caption = element_text(color = "#454543", face = "italic"))
data_estimates_pa_mcar_20$source <-
factor(data_estimates_pa_mcar_20$source,
levels = c("Observed", "MICE", "J2R", "LOCF", "LWD"))
plot_estimates_pa_mcar_20 <-
ggplot(data_estimates_pa_mcar_20, aes(source, point_estimate)) +
geom_point() +
geom_errorbar(aes(ymin = lower, ymax = upper)) +
geom_hline(yintercept = observed_pa_low,
linetype = "dashed",
linewidth = 1,
color = "#46e7fd") +
geom_hline(yintercept = observed_pa_est,
linewidth = 2,
color = "#e18b22") +
geom_hline(yintercept = observed_pa_high,
linetype = "dashed",
linewidth = 1,
color = "#4739a2") +
labs(title = "Estimating treatment effect on physical-activity",
subtitle = "Estimates and Confidence Intervals",
caption = "Data source: Cardiovascular Rehabilitation Tool") +
xlab("Method for managing dropout") +
ylab("Parameter estimate") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
plot.title = element_text(color = "#2F2E41", size = 12, face = "bold"),
plot.subtitle = element_text(color = "#454543", face = "bold"),
plot.caption = element_text(color = "#454543", face = "italic"))
Observed_pa_high
observed_pa_high <-
observed_model_summary_pa$coefficients[12] +
1.96*(observed_model_summary_pa$coefficients[12, 2])
source("R/09_visualise_estimates.R")
plot_sc_mcar <-
plot_grid(plot_estimates_sc_mcar_20,
plot_estimates_sc_mcar_30,
plot_estimates_sc_mcar_40,
labels = "AUTO")
plot_sc_mcar
Observed_sc_high
source("R/09_visualise_estimates.R")
plot_sc_mcar <-
plot_grid(plot_estimates_sc_mcar_20,
plot_estimates_sc_mcar_30,
plot_estimates_sc_mcar_40,
labels = "AUTO")
plot_sc_mcar
source("R/09_visualise_estimates.R")
plot_sc_mcar <-
plot_grid(plot_estimates_sc_mcar_20,
plot_estimates_sc_mcar_30,
plot_estimates_sc_mcar_40,
labels = "AUTO")
plot_sc_mcar
plot_sc_mar <-
plot_grid(plot_estimates_sc_mar_20,
plot_estimates_sc_mar_30,
plot_estimates_sc_mar_40,
labels = "AUTO")
plot_sc_mar
plot_sc_mnar <-
plot_grid(plot_estimates_sc_mnar_20,
plot_estimates_sc_mnar_30,
plot_estimates_sc_mnar_40,
labels = "AUTO")
plot_sc_mnar
plot_pa_mcar <-
plot_grid(plot_estimates_pa_mcar_20,
plot_estimates_pa_mcar_30,
plot_estimates_pa_mcar_40,
labels = "AUTO")
plot_pa_mcar
plot_pa_mar <-
plot_grid(plot_estimates_pa_mar_20,
plot_estimates_pa_mar_30,
plot_estimates_pa_mar_40,
labels = "AUTO")
plot_pa_mar
plot_pa_mnar <-
plot_grid(plot_estimates_pa_mnar_20,
plot_estimates_pa_mnar_30,
plot_estimates_pa_mnar_40,
labels = "AUTO")
plot_pa_mnar
